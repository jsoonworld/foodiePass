# FoodiePass Backend - Hypotheses

> **목적**: 백엔드 구현 시 "왜 이 기능을 만드는가"를 이해하기 위한 핵심 가설 요약

---

## 핵심 문제

**여행객이 외국어 메뉴판을 마주할 때 '정보 비대칭'으로 인해 '주문 실패의 불안'을 겪습니다.**

- 텍스트 번역만으로는 음식이 어떻게 생겼는지, 얼마나 비싼지 감이 오지 않음
- 이 불안이 여행의 즐거움인 '식도락 경험'을 망설이게 만듦

---

## 검증할 핵심 가설

### H1: 핵심 가치 가설
> "여행객은 [텍스트 번역만]으로는 여전히 '주문 불안'을 느끼지만, **사진/설명/환율이 포함된 시각적 메뉴**가 제공될 경우, '주문에 대한 확신'을 갖게 된다."

**백엔드의 역할**:
- A/B 그룹 배정 로직 구현 (Control vs Treatment)
- Treatment 그룹에만 음식 사진/설명 제공

---

### H2: 기술 실현 가설
> "우리는 OCR, 환율 API, 음식 매칭 시스템을 통해, **70% 이상의 연관성**으로 [사진/설명]과 **95% 이상의 정확도**로 [환율] 정보를 제공할 수 있다."

**백엔드의 역할**:
- OCR 파이프라인 (Google Vertex AI)
- 번역 파이프라인 (Google Translation)
- 음식 매칭 파이프라인 (TasteAtlas)
- 환율 변환 (Currency API)
- **처리 시간 ≤ 5초** 달성

**성공 기준**:
- OCR 정확도 ≥ 90%
- 환율 정확도 ≥ 95%
- 음식 매칭 연관성 ≥ 70%
- 전체 처리 시간 ≤ 5초

---

### H3: 사용자 행동/인지 가설
> "[시각적 메뉴]를 사용한 집단은, [텍스트 번역만] 사용한 집단 대비, '확신을 갖고 주문할 수 있다'고 응답하는 비율이 **2배 이상 높을 것**이다."

**백엔드의 역할**:
- A/B 테스트 시스템 구축
- 설문 응답 수집 및 저장
- 그룹별 응답률 분석 API 제공

**성공 기준**:
- Treatment 그룹 'Yes' 응답률 ≥ 70%
- Treatment / Control 'Yes' 응답률 비율 ≥ 2.0

---

## 가설별 백엔드 기능 매핑

| 가설 | 백엔드 기능 | 구현 모듈 |
|---|---|---|
| **H1** | A/B 그룹 배정 및 조건부 처리 | `ABTestService`, `MenuService` |
| **H2** | OCR 파이프라인 | `GeminiOcrReader` (재사용) |
| **H2** | 번역 파이프라인 | `GoogleTranslationClient` (재사용) |
| **H2** | 음식 매칭 파이프라인 | `TasteAtlasFoodScrapper` (재사용) |
| **H2** | 환율 변환 | `CurrencyService` (재사용) |
| **H2** | 성능 최적화 (≤ 5초) | 비동기 처리, 캐싱 (Redis) |
| **H3** | 설문 응답 수집 | `SurveyService` |
| **H3** | A/B 테스트 결과 분석 | `ABTestService` |

---

## MVP 범위 (In Scope)

### ✅ 구현 필요
- **F-02**: OCR 파이프라인 (메뉴판 → 메뉴명/가격)
- **F-03**: 번역 파이프라인 (메뉴명 → 사용자 언어)
- **F-04**: 음식 매칭 파이프라인 (메뉴명 → 사진/설명)
- **F-05**: 환율 변환 (현지 화폐 → 사용자 화폐)
- **F-08**: A/B 그룹 배정 로직
- **F-09**: 확신도 설문 응답 수집

### ❌ 제외 (Out of Scope)
- 장바구니 기능
- 현지 언어 주문서 생성
- 로그인/회원 시스템
- 결제 시스템
- 식당 리뷰/평점

**제외 기준**: 핵심 가설(H1, H2, H3)을 검증하는 데 직접적인 영향이 없는 기능

---

## 핵심 위험 및 완화

### 기술 위험 (H2)
**위험**: OCR/매칭 정확도가 목표(90%, 70%)를 달성하지 못할 위험

**백엔드 대응**:
- Phase 3 종료 시 내부 기술 테스트 (100개 메뉴판)
- 실패 시 사용자 테스트 중단, 기술 R&D로 피봇
- Fallback: 음식 매칭 실패 시 placeholder 이미지 제공

### 성능 위험 (H2)
**위험**: 파이프라인 처리 시간이 5초를 초과할 위험

**백엔드 대응**:
- 비동기 처리 (CompletableFuture, Reactor)
- 외부 API 호출 병렬화
- Redis 캐싱 (환율, 세션)
- 성능 테스트 자동화

---

## 개발 원칙

### 1. Hypothesis-Driven Development
- 모든 기능은 특정 가설을 검증하기 위해 존재
- 가설 검증에 불필요한 기능은 제외
- "이 API로 어떤 가설을 검증하는가?" 질문 필수

### 2. Code Reuse First
- 기존 v1 코드 최대한 재사용 (`MenuService`, `CurrencyService` 등)
- 새 기능만 추가 개발 (A/B 테스트, 설문)
- 기존 도메인 구조 유지

### 3. Performance Priority
- 처리 시간 5초 이내 엄수 (H2 검증 필수 조건)
- 비동기/병렬 처리 우선
- Redis 캐싱 적극 활용

### 4. Test-Driven
- 단위 테스트: Service 레이어 비즈니스 로직
- 통합 테스트: API 엔드포인트, 파이프라인 전체 플로우
- 성능 테스트: 처리 시간 ≤ 5초 검증

---

## Quick Reference

**핵심 질문**: "이 코드로 어떤 가설을 검증하는가?"

**가설 → 기능 매핑**:
- H1: A/B 테스트 시스템
- H2: OCR + 번역 + 매칭 + 환율 파이프라인
- H3: 설문 시스템

**성공 기준 요약**:
- 기술: OCR 90%+, 매칭 70%+, 환율 95%+, 처리 5초 이내
- 사용자: Treatment 그룹 70%+ Yes, Control 대비 2배 이상

---

## 참고 문서

- [1-Pager](../../docs/1-PAGER.md) - 프로젝트 비전 및 가설 상세
- [PRD](../../docs/PRD.md) - 가설 검증 계획서
- [ARCHITECTURE.md](./ARCHITECTURE.md) - 백엔드 아키텍처
- [API_SPEC.md](./API_SPEC.md) - API 엔드포인트 설계
- [IMPLEMENTATION_PLAN.md](./IMPLEMENTATION_PLAN.md) - 구현 계획
